import{s as l}from"./supabase.ASU9rNY7.js";import"./hoisted.UJltcVt3.js";import"./index.BFAZBQoJ.js";const c=document.getElementById("contact-form"),d=document.getElementById("success-message"),u=document.getElementById("error-message"),g=document.getElementById("error-text");async function p(){try{const{data:{user:n}}=await l.auth.getUser();if(n){const{data:e}=await l.from("profiles").select("*").eq("id",n.id).single();if(e){const r=document.getElementById("first_name"),s=document.getElementById("last_name"),t=document.getElementById("email"),i=document.getElementById("phone"),a=document.getElementById("company");if(r&&e.full_name){const o=e.full_name.split(" ");r.value=o[0]||"",s&&o.length>1&&(s.value=o.slice(1).join(" "))}t&&(t.value=n.email||""),i&&(i.value=e.phone||""),a&&(a.value=e.company_name||"")}}}catch(n){console.error("Error pre-filling form:",n)}}c?.addEventListener("submit",async n=>{n.preventDefault(),d?.classList.add("hidden"),u?.classList.add("hidden");const e=c.querySelector('button[type="submit"]'),r=e.textContent;e.disabled=!0,e.innerHTML=`
      <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      Sending...
    `;try{const s=new FormData(c),t=Object.fromEntries(s),{data:{user:i}}=await l.auth.getUser(),a={first_name:t.first_name,last_name:t.last_name,email:t.email,phone:t.phone||null,company_name:t.company||null,project_type:t.project_type,message:t.message};console.log("üìù Sending contact data:",a);const{data:o,error:m}=await l.from("contact_submissions").insert([a]).select();if(m)throw console.error("‚ùå Error saving contact message:",m),new Error("Failed to save your message. Please try again.");console.log("‚úÖ Contact message saved successfully:",o),d?.classList.remove("hidden"),c.reset(),await p()}catch(s){console.error("Contact form error:",s),g&&(g.textContent=s.message||"An error occurred while sending your message."),u?.classList.remove("hidden")}finally{e.disabled=!1,e.innerHTML=r}});document.addEventListener("DOMContentLoaded",p);
